describe('BillSplitterService', function () {
    'use strict';
    beforeEach(module('peid'));
    var billSplitterService;
    beforeEach(inject(function (BillSplitterService) {
        billSplitterService = BillSplitterService;
    }));

    describe('getBreakdown', function () {

        it('should be defined', function () {
            expect(billSplitterService.getBreakdown).toBeDefined();
        });

    });

    describe('event passing', function () {
        var billSplitterService, rootScope;
        beforeEach(inject(function (BillSplitterService, $rootScope) {
            billSplitterService = BillSplitterService;
            rootScope = $rootScope;
        }));

        it('should reject malformed contacts', function () {
            spyOn(rootScope, '$emit');
            var billDetails = {
                "contacts": [
                    {"$$hashKey": "00L", "email": "a@bc.de"},
                    {"$$hashKey": "00N", "email": "a@bc.def"},
                    {"$$hashKey": "00P", "email": "a@bc.defg"}
                ],
                "billAmount": 3.13
            };
            billSplitterService.updateBillDetails(billDetails);
            // noop
            expect(rootScope.$emit).not.toHaveBeenCalled();
        });

        it('should reject malformed billAmount', function () {
            spyOn(rootScope, '$emit');
            var billDetails = {
                billAmount: 12.34,
                contacts: ["asd@fdas.cdsa", "fda@cdsacsd.cds", "fdasr.r2as@fdsacx.fas"]
            };
            billSplitterService.updateBillDetails(billDetails);
            // noop
            expect(rootScope.$emit).not.toHaveBeenCalled();
        });

        it('should reject if data is missing', function () {
            spyOn(rootScope, '$emit');
            var billDetailsMissingContacts = {
                billAmount: 12.34
            };
            var billDetailsMissingBillAmount = {
                contacts: ["asd@fdas.cdsa", "fda@cdsacsd.cds", "fdasr.r2as@fdsacx.fas"]
            };

            billSplitterService.updateBillDetails(billDetailsMissingContacts);
            // noop
            expect(rootScope.$emit).not.toHaveBeenCalled();
            billSplitterService.updateBillDetails(billDetailsMissingBillAmount);
            // noop
            expect(rootScope.$emit).not.toHaveBeenCalled();
        });

        it('should have the right event name', function () {
            spyOn(rootScope, '$emit');
            var billDetails = {
                billAmount: "860.82",
                contacts: ["asd@fdas.cdsa"]
            };

            billSplitterService.updateBillDetails(billDetails);
            expect(rootScope.$emit.mostRecentCall.args[0]).toEqual('billSplitterService.breakdownUpdated');
        });
    });

    // See https://docs.google.com/spreadsheets/d/1k4A1ejf9ZIDkn9P28dXbkZ4ZkSm3tDEjgeC25GDjGl4/edit?usp=sharing
    // for model answers
    describe("bill details calculator", function () {
        var getDecimalPlaces = function (inputString) {
            if (inputString.indexOf('.') === -1) {
                return -1;
            }
            return inputString.length - inputString.indexOf('.') - 1;
        };

        describe("roundUpDivision", function () {
            it('should give same result as google spreadsheet up to 2dp', function () {
                var modelAnswers = [
                    [490.48, 588.3, 1, 0.9],
                    [225.77, 913.93, 3, 0.248],
                    [392.33, 914.52, 8, 0.42900101],
                    [857.47, 143.19, 5, 5.98834],
                    [590.34, 368.9, 8, 1.60027108],
                    [399.12, 116.12, 4, 3.4372],
                    [655.98, 907.4, 0, 1],
                    [445.44, 26.84, 8, 16.59612519],
                    [31.74, 587.05, 5, 0.05407],
                    [20.68, 954.76, 8, 0.0216599],
                    [334.07, 976.88, 8, 0.3419765],
                    [261.54, 927.89, 10, 0.2818653074],
                    [277.29, 838.46, 6, 0.330714],
                    [617.46, 706.27, 6, 0.874255],
                    [848.37, 906.64, 10, 0.9357297274],
                    [542.67, 760.36, 0, 1],
                    [270.22, 275.19, 1, 1],
                    [976.05, 511.06, 9, 1.909854029],
                    [471.11, 651.13, 6, 0.723527],
                    [751.13, 121.59, 1, 6.2],
                    [35.01, 855.19, 6, 0.040939],
                    [132.46, 890.5, 10, 0.1487478945],
                    [318.64, 762.51, 8, 0.41788305],
                    [326.65, 694.8, 2, 0.48],
                    [796.47, 75.33, 5, 10.57308],
                    [404.24, 533.33, 6, 0.757955],
                    [19.43, 151.54, 10, 0.1282169725],
                    [138.4, 285.44, 3, 0.485],
                    [461.28, 663.19, 10, 0.6955472791],
                    [814.84, 544.1, 1, 1.5],
                    [171.75, 289.02, 7, 0.5942496],
                    [793.76, 225.23, 3, 3.525],
                    [575.73, 442.6, 4, 1.3008],
                    [162.81, 468.46, 7, 0.3475431],
                    [55.55, 272.2, 8, 0.20407789],
                    [67.43, 703.33, 9, 0.095872493],
                    [550.92, 733.07, 8, 0.75152442],
                    [548.95, 187.89, 4, 2.9217],
                    [317.42, 403.88, 5, 0.78593],
                    [976.49, 565.17, 8, 1.72778103],
                    [29.25, 195.14, 4, 0.1499],
                    [389.7, 211.6, 5, 1.84169],
                    [509.21, 62.04, 7, 8.2077692],
                    [446.95, 257.36, 7, 1.7366724],
                    [755.24, 991.63, 9, 0.761614716],
                    [817.23, 983.92, 4, 0.8306],
                    [427.72, 673.78, 5, 0.63481],
                    [91.35, 891.03, 6, 0.102522],
                    [209.7, 499.28, 2, 0.43],
                    [895.32, 572.41, 1, 1.6],
                    [176.85, 549.94, 8, 0.32158054],
                    [349.6, 846.11, 9, 0.413185047],
                    [567.3, 575.2, 4, 0.9863],
                    [264.19, 505.48, 4, 0.5227],
                    [753.46, 185.16, 4, 4.0693],
                    [131.91, 945.41, 1, 0.2],
                    [246.39, 560.1, 7, 0.4399036],
                    [668.77, 587.91, 6, 1.137539],
                    [744.11, 383.23, 10, 1.941679931],
                    [147.36, 990.32, 7, 0.1488004],
                    [433.53, 782.54, 4, 0.5541],
                    [321.61, 238.18, 0, 2],
                    [412.51, 228.7, 3, 1.804],
                    [301.47, 368.64, 6, 0.81779],
                    [486.07, 318.16, 0, 2],
                    [205.11, 263.85, 8, 0.77737351],
                    [55.85, 492.83, 9, 0.113325082],
                    [902.63, 520.28, 10, 1.73489275],
                    [42.74, 153.14, 1, 0.3],
                    [227.22, 19.54, 7, 11.6284545],
                    [13.42, 536.03, 2, 0.03],
                    [930.02, 278.26, 8, 3.34226982],
                    [5.21, 703.11, 8, 0.00740994],
                    [610.83, 576.5, 1, 1.1],
                    [121.67, 148.43, 5, 0.81972],
                    [284.6, 489.7, 1, 0.6],
                    [293.01, 846.4, 3, 0.347],
                    [18.68, 873.7, 7, 0.0213804],
                    [727.57, 56.62, 5, 12.85006],
                    [769.79, 865.89, 9, 0.889015926],
                    [419.37, 245.13, 8, 1.71080652],
                    [694.46, 817.27, 7, 0.8497315],
                    [595.52, 16.81, 6, 35.426532],
                    [530.22, 710.44, 7, 0.7463263],
                    [487.59, 747.89, 8, 0.65195417],
                    [335.03, 948.73, 7, 0.3531353],
                    [173.17, 513.38, 0, 1],
                    [814.13, 30.99, 3, 26.271],
                    [165.61, 94.77, 5, 1.7475],
                    [499.4, 611.73, 10, 0.8163732366],
                    [717.4, 86.74, 5, 8.2707],
                    [219.58, 552.74, 9, 0.3972573],
                    [560.21, 978.12, 7, 0.5727416],
                    [107.67, 513.04, 1, 0.3],
                    [724.33, 225.2, 0, 4],
                    [34.18, 321.08, 0, 1],
                    [683.58, 752.19, 6, 0.908787],
                    [985.88, 195.4, 7, 5.0454453],
                    [955.64, 573.65, 0, 2],
                    [885, 905.35, 9, 0.977522506],
                    [380.9, 729.81, 10, 0.5219166633],
                    [472.71, 218.44, 10, 2.164026735],
                    [108.58, 934.54, 0, 1],
                    [677.8, 698, 8, 0.97106018],
                    [171.23, 56.39, 1, 3.1],
                    [819.4, 778.17, 1, 1.1],
                    [837.94, 167.41, 2, 5.01],
                    [723.5, 440.2, 8, 1.64357111],
                    [442.95, 609.33, 6, 0.726946],
                    [486.95, 86.54, 4, 5.6269],
                    [405.98, 628.67, 6, 0.645777],
                    [25.47, 899.65, 3, 0.029],
                    [840.63, 235.3, 5, 3.57259],
                    [472.18, 79.53, 6, 5.937131],
                    [709.44, 236.37, 6, 3.001397],
                    [932.1, 576.12, 0, 2],
                    [481.78, 908.16, 10, 0.5305012333],
                    [479.41, 925.66, 1, 0.6],
                    [813.27, 592.49, 9, 1.372630762],
                    [747.39, 416.77, 1, 1.8],
                    [850.16, 67.53, 2, 12.59],
                    [95.2, 366.37, 9, 0.259846604],
                    [406.21, 851.19, 4, 0.4773],
                    [435.56, 786.1, 2, 0.56],
                    [826.58, 480.14, 2, 1.73],
                    [120.38, 135.26, 1, 0.9],
                    [786.22, 181.54, 7, 4.3308362],
                    [256.67, 354.29, 6, 0.724464],
                    [338.3, 456.56, 1, 0.8],
                    [867.4, 575.79, 0, 2],
                    [82.25, 741.51, 6, 0.110923],
                    [25.97, 142.67, 1, 0.2],
                    [535.42, 150.18, 3, 3.566],
                    [540.15, 104.87, 7, 5.1506628],
                    [423.45, 53.15, 0, 8],
                    [702.82, 696.9, 2, 1.01],
                    [235.19, 968.03, 3, 0.243],
                    [779.41, 354.49, 10, 2.198679794],
                    [678.56, 548.77, 5, 1.23652],
                    [183.89, 245.87, 6, 0.747916],
                    [614.68, 830.45, 10, 0.7401770125],
                    [79.41, 664.63, 6, 0.119481],
                    [205.14, 844.38, 7, 0.2429475],
                    [500.32, 748.13, 4, 0.6688],
                    [777.68, 131.14, 0, 6],
                    [58.6, 97.16, 1, 0.7],
                    [772.22, 988.65, 8, 0.78108532],
                    [100.42, 928.43, 3, 0.109],
                    [873.54, 769.59, 10, 1.135071922],
                    [503.27, 294.49, 9, 1.708954464],
                    [449.72, 534.67, 0, 1],
                    [536.6, 762.66, 10, 0.7035900664],
                    [903.46, 554.64, 0, 2],
                    [692.56, 315.67, 9, 2.193936707],
                    [794.07, 786.17, 7, 1.0100488],
                    [669.79, 382.67, 9, 1.750307054],
                    [214.33, 610.82, 2, 0.36],
                    [761.06, 48.9, 9, 15.56359918],
                    [102.03, 981.7, 6, 0.103932],
                    [454.16, 41.38, 6, 10.975351],
                    [950.28, 158.57, 3, 5.993],
                    [758.25, 921.16, 2, 0.83],
                    [853.08, 496.84, 4, 1.7171],
                    [472.04, 603.45, 6, 0.782236],
                    [409.47, 184.79, 10, 2.21586666],
                    [623.83, 404.32, 5, 1.54292],
                    [715.98, 368.77, 0, 2],
                    [651.14, 8.62, 7, 75.5382831],
                    [335.87, 72.09, 8, 4.65903732],
                    [513.41, 251.17, 8, 2.04407374],
                    [655.76, 577.22, 7, 1.136066],
                    [15.26, 292.14, 4, 0.0523],
                    [665.89, 212.82, 4, 3.1289],
                    [781.63, 486.36, 1, 1.7],
                    [745.3, 551.74, 3, 1.351],
                    [895.09, 41.18, 3, 21.737],
                    [144.5, 998.63, 10, 0.1446982366],
                    [457.65, 923.49, 6, 0.495566],
                    [258.9, 318.02, 7, 0.8140998],
                    [756.87, 615.61, 0, 2],
                    [527.64, 346.45, 7, 1.5229904],
                    [232.66, 383.62, 6, 0.606486],
                    [505.32, 544.13, 3, 0.929],
                    [694.34, 68.69, 4, 10.1084],
                    [795.79, 98.77, 9, 8.057001114],
                    [820.13, 849.35, 9, 0.965597222],
                    [643.87, 503.08, 10, 1.279856087],
                    [673.75, 465.27, 8, 1.44808391],
                    [917.37, 218.96, 9, 4.189669346],
                    [46.15, 505.37, 2, 0.1],
                    [419.4, 628.38, 1, 0.7],
                    [821.46, 214.73, 0, 4],
                    [221.72, 691.81, 0, 1],
                    [180.82, 987.29, 2, 0.19],
                    [350.87, 907.59, 3, 0.387],
                    [400.3, 110.27, 9, 3.630180467],
                    [367.73, 434.71, 8, 0.84592027],
                    [831.24, 189.98, 1, 4.4],
                    [412.96, 831.74, 6, 0.496502],
                    [633.53, 998.41, 3, 0.635],
                    [227.47, 326.9, 3, 0.696],
                    [182.32, 670.37, 10, 0.2719692111],
                    [661.21, 998.73, 4, 0.6621],
                    [204.34, 389.69, 7, 0.5243656],
                    [743.2, 672.11, 10, 1.105771377],
                    [493.67, 21.15, 0, 24],
                    [568.74, 755.02, 1, 0.8],
                    [83.54, 865.74, 8, 0.09649549],
                    [961.95, 24.21, 0, 40],
                    [539.48, 588.28, 3, 0.918],
                    [66.17, 452, 0, 1],
                    [320.28, 838.11, 4, 0.3822],
                    [3.26, 325.87, 2, 0.02],
                    [112.41, 559.06, 5, 0.20107],
                    [406.21, 992.37, 5, 0.40934],
                    [567.58, 70.52, 9, 8.048496881],
                    [673.88, 737.26, 7, 0.9140331],
                    [803.63, 756.69, 3, 1.063],
                    [10.48, 346.61, 7, 0.0302358],
                    [408.96, 389.12, 10, 1.050986842],
                    [807.68, 364.49, 6, 2.215919],
                    [18.31, 443.34, 7, 0.0413002],
                    [398.71, 630.59, 1, 0.7],
                    [2.34, 174.1, 7, 0.0134406],
                    [178.96, 337.01, 5, 0.53103],
                    [588.6, 55.67, 10, 10.57301958],
                    [148.83, 153.21, 9, 0.971411788],
                    [163.88, 551.29, 7, 0.2972665],
                    [14.73, 328.62, 4, 0.0449],
                    [406.71, 75.03, 9, 5.420631748],
                    [591.46, 566.01, 1, 1.1],
                    [777.35, 683.74, 2, 1.14],
                    [714.18, 668.42, 6, 1.06846],
                    [215.4, 169.36, 6, 1.271847],
                    [603.67, 877.09, 7, 0.6882647],
                    [333.16, 201.18, 2, 1.66],
                    [372.91, 646.15, 2, 0.58],
                    [66.09, 334.38, 1, 0.2],
                    [433.69, 627.45, 5, 0.6912],
                    [476.69, 598.87, 5, 0.79599],
                    [104.91, 480.54, 3, 0.219],
                    [982.81, 8.82, 10, 111.4297052],
                    [962.58, 970.38, 7, 0.991962],
                    [677, 387.87, 8, 1.74543017],
                    [957.31, 689.83, 10, 1.387747706],
                    [54.73, 41.8, 8, 1.30933015],
                    [188.26, 743.34, 10, 0.2532623026],
                    [514.44, 884.98, 7, 0.5813013],
                    [420.56, 280.52, 1, 1.5],
                    [520.8, 950.09, 8, 0.5481586],
                    [3.47, 876.22, 2, 0.01],
                    [629.93, 793.49, 2, 0.8],
                    [151.14, 253.05, 10, 0.5972732662],
                    [407.55, 118.62, 8, 3.43576126],
                    [532.04, 641.44, 9, 0.829446246],
                    [78.66, 144.57, 1, 0.6],
                    [544.61, 412.76, 4, 1.3195],
                    [933.63, 469.68, 8, 1.98780021],
                    [385.87, 318.51, 8, 1.21148473],
                    [687.5, 744.52, 2, 0.93],
                    [223.11, 369.84, 2, 0.61],
                    [205.01, 655.06, 5, 0.31297],
                    [210.3, 819.3, 1, 0.3],
                    [28.2, 4.69, 2, 6.02],
                    [334.8, 913.56, 10, 0.3664783923],
                    [690.06, 9.12, 3, 75.665],
                    [796.71, 700.28, 3, 1.138],
                    [786.98, 917.99, 5, 0.85729],
                    [801.86, 654.55, 10, 1.225055382],
                    [586.15, 342.24, 4, 1.7127],
                    [858.28, 773.91, 6, 1.109018],
                    [637.11, 990.69, 10, 0.6430972353],
                    [299.23, 942.38, 7, 0.3175259],
                    [467.35, 151.09, 7, 3.0931895],
                    [288.72, 224.07, 9, 1.288525908],
                    [201.5, 137.56, 8, 1.46481536],
                    [797.8, 587.27, 1, 1.4],
                    [537.88, 975.14, 10, 0.5515925919],
                    [353.57, 728.61, 3, 0.486],
                    [330.98, 905.56, 3, 0.366],
                    [964.22, 840.28, 9, 1.147498453],
                    [406.23, 438.78, 0, 1],
                    [799.83, 597.54, 5, 1.33854],
                    [717.2, 903.58, 5, 0.79374],
                    [573.28, 420.57, 3, 1.364],
                    [542.42, 983.97, 10, 0.5512566441],
                    [312.1, 345.79, 10, 0.9025709246],
                    [809.74, 984.56, 1, 0.9],
                    [359.59, 116.45, 9, 3.087934736],
                    [483.86, 420.72, 0, 2],
                    [91.8, 437.71, 2, 0.21],
                    [113.01, 552.12, 3, 0.205],
                    [412.01, 633.43, 6, 0.650443],
                    [415.01, 200.5, 4, 2.0699],
                    [591.45, 163.37, 8, 3.62030973],
                    [201.74, 344.52, 1, 0.6],
                    [297.25, 913.48, 1, 0.4],
                    [961.82, 752.98, 2, 1.28],
                    [596.4, 736.93, 6, 0.809304],
                    [212.4, 187.02, 9, 1.135707411]
                ];

                for (var i = 0; i < modelAnswers.length; i++) {
                    var row = modelAnswers[i];
                    var result = billSplitterService.roundUpDivision(row[0], row[1], row[2]);
                    // I only care about 2 d.p for now
                    expect(result - row[3]).toBeLessThan(Math.pow(10, -3));
                    var resultAsString = result + '';
                    expect(getDecimalPlaces(resultAsString)).toBeLessThan(row[2] + 1);
                }
            });
        });

        describe("roundUpMultiplication", function () {
            it('should give same result as google spreadsheet', function () {
                var modelAnswers = [
                    [341.02, 54.69, 10, 18650.3838],
                    [259.29, 262.38, 6, 68032.5102],
                    [719.91, 251.43, 9, 181006.9713],
                    [617.3, 903.41, 0, 557675],
                    [251.42, 224.97, 9, 56561.9574],
                    [346.74, 210.06, 6, 72836.2044],
                    [322.05, 598.38, 3, 192708.279],
                    [591.66, 489.38, 8, 289546.5708],
                    [981.99, 420.78, 8, 413201.7522],
                    [990.11, 241.88, 10, 239487.8068],
                    [638.7, 642.14, 1, 410134.9],
                    [626.96, 457.61, 0, 286904],
                    [190.25, 718.05, 9, 136609.0125],
                    [115.58, 823.39, 7, 95167.4162],
                    [73.23, 45.62, 2, 3340.76],
                    [267.44, 270.89, 9, 72446.8216],
                    [373.99, 257.24, 7, 96205.1876],
                    [750.19, 350.23, 7, 262739.0437],
                    [969.51, 680.56, 6, 659809.7256],
                    [860.16, 764.12, 6, 657265.4592],
                    [831.81, 833.4, 8, 693230.454],
                    [385.45, 688.07, 0, 265217],
                    [435.28, 942.4, 3, 410207.872],
                    [894.54, 474.92, 10, 424834.9368],
                    [419.47, 239.77, 2, 100576.33],
                    [995.1, 850.03, 0, 845865],
                    [351.84, 675.51, 0, 237672],
                    [687.33, 92.66, 3, 63687.998],
                    [881.42, 913.73, 10, 805379.8966],
                    [922.64, 66.91, 5, 61733.8424],
                    [226.31, 940.58, 2, 212862.66],
                    [370.65, 885.19, 2, 328095.68],
                    [55.6, 900.99, 4, 50095.044],
                    [290.7, 371.86, 5, 108099.702],
                    [844.27, 81.89, 1, 69137.3],
                    [599.35, 571.73, 9, 342666.3755],
                    [223.54, 927.44, 8, 207319.9376],
                    [32.1, 709.72, 9, 22782.012],
                    [540.3, 337.18, 0, 182179],
                    [929.54, 809.98, 6, 752908.8092],
                    [628.11, 884, 3, 555249.24],
                    [803.84, 968.5, 6, 778519.04],
                    [874.05, 545.13, 0, 476471],
                    [643.52, 453.77, 9, 292010.0704],
                    [922.78, 734.44, 0, 677727],
                    [782.93, 124.8, 8, 97709.664],
                    [497.76, 980.91, 6, 488257.7616],
                    [936.82, 421.82, 4, 395169.4124],
                    [626.61, 340.62, 9, 213435.8982],
                    [724.13, 548.25, 7, 397004.2725],
                    [147.14, 337.12, 0, 49604],
                    [176.58, 645.98, 5, 114067.1484],
                    [435.04, 878.76, 5, 382295.7504],
                    [546.04, 322.59, 0, 176148],
                    [354.31, 635.13, 5, 225032.9103],
                    [343.42, 946.88, 1, 325177.6],
                    [84.99, 907.98, 3, 77169.221],
                    [318.06, 648.45, 0, 206247],
                    [658.12, 193.26, 1, 127188.3],
                    [829.29, 971.24, 9, 805439.6196],
                    [227.87, 695.99, 5, 158595.2413],
                    [283.69, 7.63, 5, 2164.5547],
                    [670.01, 774.7, 6, 519056.747],
                    [478.71, 517.34, 10, 247655.8314],
                    [425.18, 107.61, 5, 45753.6198],
                    [474.56, 788.8, 2, 374332.93],
                    [343.08, 691.97, 0, 237402],
                    [133.55, 673.93, 8, 90003.3515],
                    [948.61, 217.55, 8, 206370.1055],
                    [544.65, 501.74, 2, 273272.7],
                    [187.44, 953.74, 6, 178769.0256],
                    [969.56, 202.64, 10, 196471.6384],
                    [540.48, 822.25, 9, 444409.68],
                    [685.8, 539.67, 3, 370105.686],
                    [976.68, 506.16, 7, 494356.3488],
                    [597.47, 505.05, 3, 301752.224],
                    [669.94, 193.91, 5, 129908.0654],
                    [873.1, 689.08, 9, 601635.748],
                    [698.24, 242.52, 3, 169337.165],
                    [242.13, 333.13, 7, 80660.7669],
                    [106.68, 745.42, 2, 79521.41],
                    [232.89, 231.49, 10, 53911.7061],
                    [114.77, 733.57, 7, 84191.8289],
                    [310.68, 125.16, 8, 38884.7088],
                    [826.17, 756.38, 1, 624898.5],
                    [26.05, 533.67, 10, 13902.1035],
                    [324.16, 565.52, 1, 183319],
                    [313.48, 479.32, 9, 150257.2336],
                    [359.27, 947.73, 3, 340490.958],
                    [596.04, 480.68, 7, 286504.5072],
                    [132.63, 763.1, 6, 101209.953],
                    [411.6, 813.2, 3, 334713.12],
                    [703.54, 486.85, 2, 342518.45],
                    [643.57, 970.33, 1, 624475.3],
                    [888.07, 22.8, 10, 20247.996],
                    [830.15, 699.86, 5, 580988.779],
                    [825.23, 954.92, 1, 788028.7],
                    [358.69, 958.29, 1, 343729.1],
                    [660.41, 384.07, 4, 253643.6687],
                    [999.01, 719.59, 7, 718877.6059],
                    [597.85, 915.03, 10, 547050.6855],
                    [266.67, 219.79, 8, 58611.3993],
                    [301.15, 526.4, 8, 158525.36],
                    [560.68, 921.78, 5, 516823.6104],
                    [747.26, 981.83, 8, 733682.2858],
                    [125.03, 76.73, 4, 9593.5519],
                    [965.82, 95.52, 1, 92255.2],
                    [319.72, 151.85, 5, 48549.482],
                    [2.62, 712.93, 4, 1867.8766],
                    [846.99, 828.57, 7, 701790.5043],
                    [141.53, 334.33, 10, 47317.7249],
                    [798.92, 566.13, 0, 452293],
                    [189.21, 217.07, 2, 41071.82],
                    [220.69, 520.57, 8, 114884.5933],
                    [85.33, 822.58, 6, 70190.7514],
                    [314.44, 631, 8, 198411.64],
                    [441.12, 105.78, 2, 46661.68],
                    [143.22, 984.75, 1, 141035.9],
                    [850.6, 313.54, 6, 266697.124],
                    [385.52, 782.24, 1, 301569.2],
                    [60.58, 302.75, 3, 18340.595],
                    [195.85, 797.34, 6, 156159.039],
                    [754.42, 496.9, 7, 374871.298],
                    [853.96, 707.19, 1, 603912],
                    [805.6, 269.22, 5, 216883.632],
                    [648.38, 910.06, 6, 590064.7028],
                    [222.58, 14.5, 4, 3227.41],
                    [304.29, 904.13, 0, 275118],
                    [548.7, 403.9, 8, 221619.93],
                    [400.54, 233.77, 8, 93634.2358],
                    [437.88, 208.12, 10, 91131.5856],
                    [247.6, 772.52, 0, 191276],
                    [316.87, 732.13, 6, 231990.0331],
                    [942.89, 379.29, 5, 357628.7481],
                    [113, 888.96, 1, 100452.5],
                    [60.66, 991.99, 5, 60174.1134],
                    [696.6, 512.11, 3, 356735.826],
                    [151.43, 93.49, 7, 14157.1907],
                    [10.64, 883.54, 0, 9401],
                    [855.88, 359.66, 6, 307825.8008],
                    [467.6, 54.61, 10, 25535.636],
                    [617.65, 667.76, 5, 412441.964],
                    [542.22, 233.27, 5, 126483.6594],
                    [299.24, 572.37, 3, 171275.999],
                    [115.07, 877.83, 10, 101011.8981],
                    [259.89, 741.9, 7, 192812.391],
                    [890.15, 703.04, 9, 625811.056],
                    [889.67, 664.3, 9, 591007.781],
                    [562.64, 300.8, 8, 169242.112],
                    [161.82, 477.57, 3, 77280.378],
                    [619.43, 688.98, 6, 426774.8814],
                    [367.4, 940.1, 7, 345392.74],
                    [67, 715.95, 5, 47968.65],
                    [940.62, 34.12, 8, 32093.9544],
                    [671.1, 705.98, 0, 473784],
                    [727.58, 279.95, 3, 203686.021],
                    [719.57, 75.89, 4, 54608.1673],
                    [459.79, 643.46, 0, 295857],
                    [963.07, 383.03, 0, 368885],
                    [782.09, 635.37, 10, 496916.5233],
                    [412.49, 579.2, 5, 238914.208],
                    [370.64, 351.39, 4, 130239.1896],
                    [563, 297.55, 6, 167520.65],
                    [333.86, 383.08, 8, 127895.0888],
                    [442.8, 146.95, 8, 65069.46],
                    [791.88, 669.1, 6, 529846.908],
                    [543.49, 39.38, 3, 21402.637],
                    [806.76, 959.18, 9, 773828.0568],
                    [152.83, 43.82, 5, 6697.0106],
                    [417.77, 962.37, 3, 402049.315],
                    [181.73, 611.25, 7, 111082.4625],
                    [608.63, 857.18, 7, 521705.4634],
                    [134.53, 917.14, 1, 123382.9],
                    [483.28, 394.45, 6, 190629.796],
                    [123.48, 644.15, 4, 79539.642],
                    [595.49, 640.47, 9, 381393.4803],
                    [561.62, 602.1, 1, 338151.5],
                    [308.65, 634.46, 3, 195826.079],
                    [495.67, 934.74, 0, 463323],
                    [752.69, 93.83, 1, 70625],
                    [155.77, 272.73, 6, 42483.1521],
                    [595.76, 345.17, 0, 205639],
                    [722.62, 496.38, 3, 358694.116],
                    [611.38, 18.18, 9, 11114.8884],
                    [141.64, 906.31, 9, 128369.7484],
                    [255.38, 671.3, 2, 171436.6],
                    [977.12, 655.97, 0, 640962],
                    [978.74, 459.06, 1, 449300.4],
                    [300.8, 572.48, 2, 172201.99],
                    [306.77, 564.68, 10, 173226.8836],
                    [781.16, 726.34, 4, 567387.7544],
                    [276.15, 351.59, 10, 97091.5785],
                    [895.15, 758.51, 8, 678980.2265],
                    [310.55, 802.17, 3, 249113.894],
                    [260.02, 436.65, 7, 113537.733],
                    [151.16, 663.44, 6, 100285.5904],
                    [798.28, 799.06, 2, 637873.62],
                    [870.26, 979.79, 0, 852673],
                    [949.09, 613.42, 7, 582190.7878],
                    [58.12, 122.13, 2, 7098.2],
                    [646.63, 490.82, 2, 317378.94],
                    [970.17, 599.01, 5, 581141.5317],
                    [854.49, 570.15, 8, 487187.4735],
                    [186.3, 524.03, 0, 97627],
                    [202.32, 141.88, 1, 28705.2],
                    [304.05, 600.56, 5, 182600.268],
                    [676.47, 285.81, 4, 193341.8907],
                    [455.4, 440.05, 6, 200398.77],
                    [405.52, 630.67, 7, 255749.2984],
                    [293.94, 346.84, 8, 101950.1496],
                    [719.18, 730.83, 10, 525598.3194],
                    [295.48, 856.45, 2, 253063.85],
                    [786.73, 530.78, 6, 417580.5494],
                    [197.93, 105.25, 9, 20832.1325],
                    [30.44, 633.66, 7, 19288.6104],
                    [581.53, 919.06, 6, 534460.9618],
                    [7.85, 995.54, 1, 7815],
                    [562.45, 543.45, 10, 305663.4525],
                    [742.12, 571.76, 4, 424314.5312],
                    [402.51, 485.56, 10, 195442.7556],
                    [305.91, 890.5, 10, 272412.855],
                    [287.35, 611.15, 2, 175613.96],
                    [415.04, 518.19, 10, 215069.5776],
                    [310.5, 632.48, 10, 196385.04],
                    [524.58, 611.77, 5, 320922.3066],
                    [740.87, 454.06, 8, 336399.4322],
                    [430.8, 877.97, 4, 378229.476],
                    [317.85, 612.75, 7, 194762.5875],
                    [235.42, 134.96, 1, 31772.3],
                    [686.96, 682.04, 2, 468534.2],
                    [119.39, 608.31, 9, 72626.1309],
                    [188.09, 13.86, 9, 2606.9274],
                    [175.31, 101.87, 0, 17859],
                    [268.62, 396.72, 10, 106566.9264],
                    [362.38, 232.18, 7, 84137.3884],
                    [501.53, 28.37, 0, 14229],
                    [855.65, 171.23, 5, 146512.9495],
                    [928.81, 872.99, 6, 810841.8419],
                    [870.05, 427.24, 4, 371720.162],
                    [566.79, 815.66, 6, 462307.9314],
                    [735.31, 434.95, 3, 319823.085],
                    [944.52, 684.3, 0, 646336],
                    [194.77, 400.11, 1, 77929.5],
                    [496.77, 907.38, 1, 450759.2],
                    [791.94, 432.61, 8, 342601.1634],
                    [199.39, 363.49, 4, 72476.2711],
                    [813.47, 440.74, 3, 358528.768],
                    [671.12, 489.1, 4, 328244.792],
                    [674.37, 184.88, 8, 124677.5256],
                    [927.09, 398.85, 7, 369769.8465],
                    [289.23, 892.31, 6, 258082.8213],
                    [366.27, 176.71, 6, 64723.5717],
                    [874.22, 710.35, 5, 621002.177],
                    [420.39, 479.42, 1, 201543.4],
                    [604.08, 269.33, 7, 162696.8664],
                    [550.52, 598.45, 4, 329458.694],
                    [515.65, 690.45, 10, 356030.5425],
                    [119.29, 423.96, 1, 50574.2],
                    [245.55, 409.69, 3, 100599.38],
                    [713.36, 692.33, 7, 493880.5288],
                    [429.64, 303.57, 0, 130426],
                    [67.51, 154.85, 2, 10453.93],
                    [524.03, 356.33, 2, 186727.61],
                    [126.67, 133.11, 2, 16861.05],
                    [152.9, 762.34, 5, 116561.786],
                    [457.47, 411.16, 9, 188093.3652],
                    [900.28, 129.57, 6, 116649.2796],
                    [119.94, 714.68, 3, 85718.72],
                    [371.36, 756.78, 1, 281037.9],
                    [871.87, 634.4, 10, 553114.328],
                    [810.29, 673.73, 2, 545916.69],
                    [792.55, 830.75, 9, 658410.9125],
                    [114.19, 831.25, 5, 94920.4375],
                    [873.99, 605.93, 5, 529576.7607],
                    [589.01, 39.46, 9, 23242.3346],
                    [83.24, 420.36, 3, 34990.767],
                    [696.91, 704.79, 6, 491175.1989],
                    [798.66, 966.85, 6, 772184.421],
                    [614.78, 298.16, 9, 183302.8048],
                    [269.98, 874.81, 0, 236182],
                    [10.61, 681.81, 9, 7234.0041],
                    [952.92, 709.14, 5, 675753.6888],
                    [723.4, 775.57, 9, 561047.338],
                    [783.47, 438.63, 2, 343653.45],
                    [259.23, 594.3, 0, 154061],
                    [947.34, 90.95, 4, 86160.573],
                    [273.42, 938.63, 0, 256641],
                    [682.82, 579.49, 10, 395687.3618],
                    [658.03, 166.79, 2, 109752.83],
                    [548.54, 199.82, 4, 109609.2628],
                    [983.72, 673, 3, 662043.56],
                    [264.38, 650.88, 9, 172079.6544],
                    [923.75, 301.79, 5, 278778.5125],
                    [268.24, 563.95, 5, 151273.948],
                    [809.93, 748.44, 6, 606184.0092],
                    [52.89, 925.8, 0, 48966],
                    [610.4, 546.08, 7, 333327.232],
                    [885.97, 794.86, 2, 704222.12],
                    [677.8, 984.7, 10, 667429.66],
                    [858.68, 741.44, 2, 636659.7]
                ];
                for (var i = 0; i < modelAnswers.length; i++) {
                    var row = modelAnswers[i];
                    var result = billSplitterService.roundUpMultiplication(row[0], row[1], row[2]);
                    // I only care about 2 d.p for now
                    expect(result - row[3]).toBeLessThan(Math.pow(10, -3));
                    var resultAsString = result + '';
                    expect(getDecimalPlaces(resultAsString)).toBeLessThan(row[2] + 1);
                }
            });
        });

        it('should take the splitter into account when deciding party size', function () {
            expect(billSplitterService.getPartySize(["asdf@fdsa.com", "fdas.dcas@cads.cdom"]))
                .toBe(3);
        });

        it('should ensure calculations are done correctly with only 2 decimal place', function () {
            var modelAnswers = [
                [717.11, 43, 16.68, 0.34, 17.02],
                [950, 9, 105.56, 2.12, 107.68],
                [340.62, 46, 7.41, 0.15, 7.56],
                [722.64, 41, 17.63, 0.36, 17.99],
                [580.09, 5, 116.02, 2.33, 118.35],
                [671.85, 27, 24.89, 0.5, 25.39],
                [685.76, 39, 17.59, 0.36, 17.95],
                [705.87, 25, 28.24, 0.57, 28.81],
                [758.22, 30, 25.28, 0.51, 25.79],
                [969.7, 43, 22.56, 0.46, 23.02],
                [578.09, 37, 15.63, 0.32, 15.95],
                [218.41, 9, 24.27, 0.49, 24.76],
                [962.15, 32, 30.07, 0.61, 30.68],
                [22.45, 17, 1.33, 0.03, 1.36],
                [49.47, 2, 24.74, 0.5, 25.24],
                [852.84, 7, 121.84, 2.44, 124.28],
                [108.02, 38, 2.85, 0.06, 2.91],
                [84.04, 35, 2.41, 0.05, 2.46],
                [477.84, 40, 11.95, 0.24, 12.19],
                [750.44, 43, 17.46, 0.35, 17.81],
                [404.89, 43, 9.42, 0.19, 9.61],
                [97.87, 29, 3.38, 0.07, 3.45],
                [128.34, 15, 8.56, 0.18, 8.74],
                [508.31, 38, 13.38, 0.27, 13.65],
                [470.83, 42, 11.22, 0.23, 11.45],
                [753.53, 47, 16.04, 0.33, 16.37],
                [860.56, 13, 66.2, 1.33, 67.53],
                [79.92, 12, 6.66, 0.14, 6.8],
                [650.42, 36, 18.07, 0.37, 18.44],
                [756.9, 10, 75.69, 1.52, 77.21],
                [462.73, 42, 11.02, 0.23, 11.25],
                [172.78, 21, 8.23, 0.17, 8.4],
                [200.12, 24, 8.34, 0.17, 8.51],
                [651.96, 26, 25.08, 0.51, 25.59],
                [148.42, 30, 4.95, 0.1, 5.05],
                [42.54, 18, 2.37, 0.05, 2.42],
                [35.79, 14, 2.56, 0.06, 2.62],
                [6.14, 3, 2.05, 0.05, 2.1],
                [983.18, 39, 25.21, 0.51, 25.72],
                [384.61, 49, 7.85, 0.16, 8.01],
                [421.57, 22, 19.17, 0.39, 19.56],
                [151.06, 9, 16.79, 0.34, 17.13],
                [396.03, 26, 15.24, 0.31, 15.55],
                [232.52, 14, 16.61, 0.34, 16.95],
                [319.93, 36, 8.89, 0.18, 9.07],
                [956.6, 32, 29.9, 0.6, 30.5],
                [474.46, 22, 21.57, 0.44, 22.01],
                [386.06, 41, 9.42, 0.19, 9.61],
                [119.78, 4, 29.95, 0.6, 30.55],
                [308.61, 44, 7.02, 0.15, 7.17],
                [442.42, 41, 10.8, 0.22, 11.02],
                [913.45, 19, 48.08, 0.97, 49.05],
                [113.07, 3, 37.69, 0.76, 38.45],
                [59.11, 44, 1.35, 0.03, 1.38],
                [576.47, 5, 115.3, 2.31, 117.61],
                [697.83, 48, 14.54, 0.3, 14.84],
                [399.54, 18, 22.2, 0.45, 22.65],
                [223.03, 3, 74.35, 1.49, 75.84],
                [828.42, 40, 20.72, 0.42, 21.14],
                [831.82, 14, 59.42, 1.19, 60.61],
                [865.42, 42, 20.61, 0.42, 21.03],
                [106.33, 7, 15.19, 0.31, 15.5],
                [591.76, 38, 15.58, 0.32, 15.9],
                [903.03, 30, 30.11, 0.61, 30.72],
                [503.77, 35, 14.4, 0.29, 14.69],
                [867.7, 1, 867.7, 17.36, 885.06],
                [373.99, 5, 74.8, 1.5, 76.3],
                [858.9, 49, 17.53, 0.36, 17.89],
                [622.39, 38, 16.38, 0.33, 16.71],
                [740.23, 13, 56.95, 1.14, 58.09],
                [618.89, 16, 38.69, 0.78, 39.47],
                [191.02, 38, 5.03, 0.11, 5.14],
                [420.18, 9, 46.69, 0.94, 47.63],
                [768.41, 16, 48.03, 0.97, 49],
                [560.07, 30, 18.67, 0.38, 19.05],
                [636.96, 20, 31.85, 0.64, 32.49],
                [3.14, 11, 0.29, 0.01, 0.3],
                [452.91, 2, 226.46, 4.53, 230.99],
                [781.36, 19, 41.13, 0.83, 41.96],
                [462.27, 6, 77.05, 1.55, 78.6],
                [158.62, 24, 6.61, 0.14, 6.75],
                [137.19, 36, 3.82, 0.08, 3.9],
                [109.53, 22, 4.98, 0.1, 5.08],
                [655.32, 20, 32.77, 0.66, 33.43],
                [109.73, 8, 13.72, 0.28, 14],
                [319.16, 41, 7.79, 0.16, 7.95],
                [571.61, 11, 51.97, 1.04, 53.01],
                [44.77, 35, 1.28, 0.03, 1.31],
                [31.14, 46, 0.68, 0.02, 0.7],
                [325.7, 27, 12.07, 0.25, 12.32],
                [411.52, 7, 58.79, 1.18, 59.97],
                [432.34, 2, 216.17, 4.33, 220.5],
                [323.68, 27, 11.99, 0.24, 12.23],
                [949.07, 43, 22.08, 0.45, 22.53],
                [579.59, 2, 289.8, 5.8, 295.6],
                [322.84, 44, 7.34, 0.15, 7.49],
                [516.88, 15, 34.46, 0.69, 35.15],
                [711.66, 13, 54.75, 1.1, 55.85],
                [684.15, 33, 20.74, 0.42, 21.16],
                [728.84, 28, 26.03, 0.53, 26.56],
                [197.16, 33, 5.98, 0.12, 6.1],
                [399.03, 41, 9.74, 0.2, 9.94],
                [125.41, 13, 9.65, 0.2, 9.85],
                [829.24, 19, 43.65, 0.88, 44.53],
                [543.78, 22, 24.72, 0.5, 25.22],
                [381.36, 18, 21.19, 0.43, 21.62],
                [19.61, 46, 0.43, 0.01, 0.44],
                [968.95, 23, 42.13, 0.85, 42.98],
                [895.67, 44, 20.36, 0.41, 20.77],
                [29.15, 12, 2.43, 0.05, 2.48],
                [565.69, 33, 17.15, 0.35, 17.5],
                [601.13, 4, 150.29, 3.01, 153.3],
                [269.07, 31, 8.68, 0.18, 8.86],
                [221.75, 26, 8.53, 0.18, 8.71],
                [706.48, 41, 17.24, 0.35, 17.59],
                [293.98, 24, 12.25, 0.25, 12.5],
                [899.43, 21, 42.83, 0.86, 43.69],
                [545.75, 12, 45.48, 0.91, 46.39],
                [293.07, 23, 12.75, 0.26, 13.01],
                [850.83, 6, 141.81, 2.84, 144.65],
                [690.66, 12, 57.56, 1.16, 58.72],
                [285.24, 46, 6.21, 0.13, 6.34],
                [473.86, 49, 9.68, 0.2, 9.88],
                [925.25, 26, 35.59, 0.72, 36.31],
                [920.27, 31, 29.69, 0.6, 30.29],
                [716.9, 30, 23.9, 0.48, 24.38],
                [698.4, 38, 18.38, 0.37, 18.75],
                [252.19, 39, 6.47, 0.13, 6.6],
                [671.48, 37, 18.15, 0.37, 18.52],
                [540.59, 30, 18.02, 0.37, 18.39],
                [551.58, 38, 14.52, 0.3, 14.82],
                [761.64, 45, 16.93, 0.34, 17.27],
                [241.33, 24, 10.06, 0.21, 10.27],
                [499.37, 42, 11.89, 0.24, 12.13],
                [615.17, 45, 13.68, 0.28, 13.96],
                [393.18, 22, 17.88, 0.36, 18.24],
                [208.65, 50, 4.18, 0.09, 4.27],
                [373.07, 13, 28.7, 0.58, 29.28],
                [691.2, 7, 98.75, 1.98, 100.73],
                [387.49, 2, 193.75, 3.88, 197.63],
                [936.33, 31, 30.21, 0.61, 30.82],
                [565.41, 16, 35.34, 0.71, 36.05],
                [15.8, 29, 0.55, 0.02, 0.57],
                [195.64, 9, 21.74, 0.44, 22.18],
                [29.71, 14, 2.13, 0.05, 2.18],
                [447.3, 25, 17.9, 0.36, 18.26],
                [542.34, 37, 14.66, 0.3, 14.96],
                [916.84, 1, 916.84, 18.34, 935.18],
                [675.73, 38, 17.79, 0.36, 18.15],
                [467.41, 2, 233.71, 4.68, 238.39],
                [979.03, 50, 19.59, 0.4, 19.99],
                [352.9, 2, 176.45, 3.53, 179.98],
                [847.82, 16, 52.99, 1.06, 54.05],
                [795.93, 48, 16.59, 0.34, 16.93],
                [28.81, 40, 0.73, 0.02, 0.75],
                [349.66, 13, 26.9, 0.54, 27.44],
                [76.45, 23, 3.33, 0.07, 3.4],
                [928.93, 47, 19.77, 0.4, 20.17],
                [198.44, 9, 22.05, 0.45, 22.5],
                [86.07, 45, 1.92, 0.04, 1.96],
                [857.98, 45, 19.07, 0.39, 19.46],
                [247.52, 17, 14.56, 0.3, 14.86],
                [619.02, 4, 154.76, 3.1, 157.86],
                [365.86, 19, 19.26, 0.39, 19.65],
                [802.56, 48, 16.72, 0.34, 17.06],
                [0.27, 44, 0.01, 0.01, 0.02],
                [551.01, 14, 39.36, 0.79, 40.15],
                [769.73, 36, 21.39, 0.43, 21.82],
                [306.28, 17, 18.02, 0.37, 18.39],
                [556.81, 27, 20.63, 0.42, 21.05],
                [635.41, 48, 13.24, 0.27, 13.51],
                [732.92, 48, 15.27, 0.31, 15.58],
                [873.73, 42, 20.81, 0.42, 21.23],
                [66.82, 26, 2.57, 0.06, 2.63],
                [495.83, 28, 17.71, 0.36, 18.07],
                [227.99, 13, 17.54, 0.36, 17.9],
                [214.3, 18, 11.91, 0.24, 12.15],
                [850.88, 27, 31.52, 0.64, 32.16],
                [997.12, 6, 166.19, 3.33, 169.52],
                [752.9, 37, 20.35, 0.41, 20.76],
                [888.48, 15, 59.24, 1.19, 60.43],
                [948.65, 35, 27.11, 0.55, 27.66],
                [322.08, 12, 26.84, 0.54, 27.38],
                [751.29, 41, 18.33, 0.37, 18.7],
                [590.57, 30, 19.69, 0.4, 20.09],
                [254.13, 11, 23.11, 0.47, 23.58],
                [40.78, 36, 1.14, 0.03, 1.17],
                [424.56, 31, 13.7, 0.28, 13.98],
                [119.41, 5, 23.89, 0.48, 24.37],
                [579.44, 11, 52.68, 1.06, 53.74],
                [516.06, 37, 13.95, 0.28, 14.23],
                [135.32, 23, 5.89, 0.12, 6.01],
                [711.28, 37, 19.23, 0.39, 19.62],
                [805.69, 40, 20.15, 0.41, 20.56],
                [313.58, 43, 7.3, 0.15, 7.45],
                [246.41, 11, 22.41, 0.45, 22.86],
                [687.3, 16, 42.96, 0.86, 43.82],
                [3.07, 50, 0.07, 0.01, 0.08],
                [766.64, 24, 31.95, 0.64, 32.59],
                [292.24, 35, 8.35, 0.17, 8.52],
                [302.03, 29, 10.42, 0.21, 10.63],
                [32.37, 22, 1.48, 0.03, 1.51],
                [483.51, 39, 12.4, 0.25, 12.65],
                [836.52, 11, 76.05, 1.53, 77.58],
                [271.16, 47, 5.77, 0.12, 5.89],
                [676.2, 6, 112.7, 2.26, 114.96],
                [378.82, 36, 10.53, 0.22, 10.75],
                [235.39, 45, 5.24, 0.11, 5.35],
                [702.9, 1, 702.9, 14.06, 716.96],
                [790.44, 44, 17.97, 0.36, 18.33],
                [761.09, 4, 190.28, 3.81, 194.09],
                [794.76, 20, 39.74, 0.8, 40.54],
                [61.28, 14, 4.38, 0.09, 4.47],
                [315.23, 50, 6.31, 0.13, 6.44],
                [114.7, 46, 2.5, 0.05, 2.55],
                [488.12, 26, 18.78, 0.38, 19.16],
                [348.79, 31, 11.26, 0.23, 11.49],
                [239.66, 34, 7.05, 0.15, 7.2],
                [477.1, 38, 12.56, 0.26, 12.82],
                [483.4, 12, 40.29, 0.81, 41.1],
                [912.24, 12, 76.02, 1.53, 77.55],
                [775.51, 2, 387.76, 7.76, 395.52],
                [731.67, 26, 28.15, 0.57, 28.72],
                [217.48, 13, 16.73, 0.34, 17.07],
                [146.91, 49, 3, 0.06, 3.06],
                [62.53, 50, 1.26, 0.03, 1.29],
                [710.96, 14, 50.79, 1.02, 51.81],
                [651.62, 35, 18.62, 0.38, 19],
                [903.11, 39, 23.16, 0.47, 23.63],
                [701.66, 14, 50.12, 1.01, 51.13],
                [737.19, 19, 38.8, 0.78, 39.58],
                [643.65, 17, 37.87, 0.76, 38.63],
                [583.7, 27, 21.62, 0.44, 22.06],
                [292.47, 7, 41.79, 0.84, 42.63],
                [114.29, 20, 5.72, 0.12, 5.84],
                [80.05, 6, 13.35, 0.27, 13.62],
                [761.47, 3, 253.83, 5.08, 258.91],
                [936.81, 40, 23.43, 0.47, 23.9],
                [129.61, 49, 2.65, 0.06, 2.71],
                [525.88, 45, 11.69, 0.24, 11.93],
                [643.05, 8, 80.39, 1.61, 82],
                [363.84, 20, 18.2, 0.37, 18.57],
                [323.99, 44, 7.37, 0.15, 7.52],
                [670.74, 35, 19.17, 0.39, 19.56],
                [858.79, 3, 286.27, 5.73, 292],
                [929.24, 10, 92.93, 1.86, 94.79],
                [144.78, 13, 11.14, 0.23, 11.37],
                [775.58, 13, 59.66, 1.2, 60.86],
                [247.28, 34, 7.28, 0.15, 7.43],
                [609.68, 17, 35.87, 0.72, 36.59],
                [658.65, 46, 14.32, 0.29, 14.61],
                [733.81, 37, 19.84, 0.4, 20.24],
                [624.71, 12, 52.06, 1.05, 53.11],
                [277.83, 39, 7.13, 0.15, 7.28],
                [497.55, 44, 11.31, 0.23, 11.54],
                [147.15, 16, 9.2, 0.19, 9.39],
                [783.54, 14, 55.97, 1.12, 57.09],
                [649.77, 17, 38.23, 0.77, 39],
                [870.31, 37, 23.53, 0.48, 24.01],
                [351.14, 12, 29.27, 0.59, 29.86],
                [582.73, 20, 29.14, 0.59, 29.73],
                [99.71, 25, 3.99, 0.08, 4.07],
                [10.01, 1, 10.01, 0.21, 10.22],
                [60.22, 10, 6.03, 0.13, 6.16],
                [579.28, 24, 24.14, 0.49, 24.63],
                [580.72, 9, 64.53, 1.3, 65.83],
                [205.35, 31, 6.63, 0.14, 6.77],
                [551.98, 10, 55.2, 1.11, 56.31],
                [305.01, 49, 6.23, 0.13, 6.36],
                [637.91, 9, 70.88, 1.42, 72.3],
                [644.17, 12, 53.69, 1.08, 54.77],
                [860.82, 2, 430.41, 8.61, 439.02],
                [77.76, 47, 1.66, 0.04, 1.7],
                [714.28, 25, 28.58, 0.58, 29.16],
                [766.9, 26, 29.5, 0.59, 30.09],
                [404.21, 26, 15.55, 0.32, 15.87],
                [14.44, 7, 2.07, 0.05, 2.12],
                [341.13, 31, 11.01, 0.23, 11.24],
                [374.31, 38, 9.86, 0.2, 10.06],
                [432.44, 34, 12.72, 0.26, 12.98],
                [668.14, 7, 95.45, 1.91, 97.36],
                [566.82, 43, 13.19, 0.27, 13.46],
                [316.41, 26, 12.17, 0.25, 12.42],
                [408.61, 14, 29.19, 0.59, 29.78],
                [372.85, 41, 9.1, 0.19, 9.29],
                [897.15, 44, 20.39, 0.41, 20.8],
                [578.87, 4, 144.72, 2.9, 147.62],
                [797.17, 31, 25.72, 0.52, 26.24],
                [946.33, 17, 55.67, 1.12, 56.79],
                [95.69, 42, 2.28, 0.05, 2.33],
                [978.83, 42, 23.31, 0.47, 23.78],
                [768.43, 11, 69.86, 1.4, 71.26],
                [875.84, 29, 30.21, 0.61, 30.82],
                [423.64, 11, 38.52, 0.78, 39.3],
                [483.6, 42, 11.52, 0.24, 11.76],
                [10.24, 11, 0.94, 0.02, 0.96],
                [490.8, 28, 17.53, 0.36, 17.89],
                [286.86, 17, 16.88, 0.34, 17.22],
                [373.89, 6, 62.32, 1.25, 63.57],
                [867.88, 31, 28, 0.56, 28.56]
            ];
            var keys = [
                'billAmount',
                'partySize',
                'costPerPerson',
                'costOfMagic',
                'billPerPerson'
            ];

            for (var i = 0; i < modelAnswers.length; i++) {
                var row = modelAnswers[i];
                var modelBreakdown = _.zipObject(keys, row);
                var breakdown = billSplitterService.calculateBreakdown(row[0], row[1]);
                for (var j = 0; j < keys.length; j++) {
                    var modelAnswerAsNumber = Number(modelBreakdown[keys[j]]);
                    var myAnswerAsNumber = Number(breakdown[keys[j]]);
                    expect(Math.abs(modelAnswerAsNumber - myAnswerAsNumber)).toBeLessThan(Math.pow(10, -3));
                }
            }
        });

        it('should return a copy in getBreakdown', function () {
            billSplitterService.updateBillDetails({
                billAmount: "12.34",
                contacts: ["asdf@asf.asf"]
            });

            var breakdown1 = billSplitterService.getBreakdown();
            var breakdown2 = billSplitterService.getBreakdown();
            expect(breakdown1).toBeDefined();
            expect(breakdown1).toEqual(breakdown2);
            expect(breakdown1).not.toBe(breakdown2);
        });

        it('should wipe data when bill is split successfully', function(){
            expect(true).toBe(false);
        });
    });
});
